<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>HT5</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="HT5_files/libs/clipboard/clipboard.min.js"></script>
<script src="HT5_files/libs/quarto-html/quarto.js"></script>
<script src="HT5_files/libs/quarto-html/popper.min.js"></script>
<script src="HT5_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="HT5_files/libs/quarto-html/anchor.min.js"></script>
<link href="HT5_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="HT5_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="HT5_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="HT5_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="HT5_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">HT5</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="ht5---naive-bayes" class="level1">
<h1>HT5 - Naive Bayes</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'ggplot2'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:psych':

    %+%, alpha</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>corrplot 0.92 loaded</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nortest)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: zoo</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'zoo'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    as.Date, as.Date.numeric</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jtools)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart.plot)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lattice</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>randomForest 4.7-1.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Type rfNews() to see new features/changes/bug fixes.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'randomForest'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggplot2':

    margin</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    combine</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:psych':

    outlier</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(klaR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'klaR' was built under R version 4.2.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: MASS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'MASS'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    select</code></pre>
</div>
</div>
<section id="cargando-los-datos" class="level2">
<h2 class="anchored" data-anchor-id="cargando-los-datos">Cargando los datos</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"train.csv"</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>datos[<span class="st">'YearsBuilt'</span>] <span class="ot">=</span> <span class="dv">2023</span> <span class="sc">-</span> datos<span class="sc">$</span>YearBuilt</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>datos[<span class="st">'YearsRem'</span>] <span class="ot">=</span> <span class="dv">2023</span> <span class="sc">-</span> datos<span class="sc">$</span>YearRemodAdd</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>numericas <span class="ot">&lt;-</span> datos[, <span class="fu">c</span>(<span class="st">'MSSubClass'</span>, <span class="st">'LotArea'</span>, <span class="st">'OverallQual'</span>, <span class="st">'OverallCond'</span>, <span class="st">'YearsBuilt'</span>, <span class="st">'YearsRem'</span>, <span class="st">'BsmtFinSF1'</span>, <span class="st">'BsmtFinSF2'</span>, <span class="st">'BsmtUnfSF'</span>, <span class="st">'TotalBsmtSF'</span>, <span class="st">'X1stFlrSF'</span>, <span class="st">'X2ndFlrSF'</span>, <span class="st">'LowQualFinSF'</span>, <span class="st">'GrLivArea'</span>, <span class="st">'BsmtFullBath'</span>, <span class="st">'BsmtHalfBath'</span>, <span class="st">'FullBath'</span>, <span class="st">'HalfBath'</span>, <span class="st">'BedroomAbvGr'</span>, <span class="st">'KitchenAbvGr'</span>, <span class="st">'TotRmsAbvGrd'</span>, <span class="st">'Fireplaces'</span>, <span class="st">'GarageCars'</span>, <span class="st">'GarageArea'</span>, <span class="st">'WoodDeckSF'</span>, <span class="st">'OpenPorchSF'</span>, <span class="st">'EnclosedPorch'</span>, <span class="st">'X3SsnPorch'</span>, <span class="st">'ScreenPorch'</span>, <span class="st">'PoolArea'</span>, <span class="st">'MiscVal'</span>, <span class="st">'MoSold'</span>, <span class="st">'SalePrice'</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="muestreo" class="level2">
<h2 class="anchored" data-anchor-id="muestreo">Muestreo</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.7</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>corte <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(datos), <span class="fu">nrow</span>(datos) <span class="sc">*</span> p)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> datos[corte,]</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> datos[<span class="sc">-</span>corte,]</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>trainNumericas <span class="ot">&lt;-</span> numericas[corte,]</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>testNumericas <span class="ot">&lt;-</span> numericas[<span class="sc">-</span>corte,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="generando-los-modelos" class="level2">
<h2 class="anchored" data-anchor-id="generando-los-modelos">Generando los modelos</h2>
<section id="modelos-de-regresión" class="level3">
<h3 class="anchored" data-anchor-id="modelos-de-regresión">Modelos de regresión</h3>
<section id="regresión-lineal-multivariable" class="level4">
<h4 class="anchored" data-anchor-id="regresión-lineal-multivariable">Regresión lineal multivariable</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>mejorModelo <span class="ot">&lt;-</span> <span class="fu">lm</span>(SalePrice <span class="sc">~</span> MSSubClass <span class="sc">+</span> LotArea <span class="sc">+</span> OverallQual <span class="sc">+</span> BsmtFinSF1 <span class="sc">+</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    BsmtFinSF2 <span class="sc">+</span> TotalBsmtSF <span class="sc">+</span> LowQualFinSF <span class="sc">+</span> HalfBath <span class="sc">+</span> KitchenAbvGr <span class="sc">+</span> </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    TotRmsAbvGrd <span class="sc">+</span> Fireplaces <span class="sc">+</span> WoodDeckSF <span class="sc">+</span> OpenPorchSF <span class="sc">+</span> EnclosedPorch <span class="sc">+</span> </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    X3SsnPorch <span class="sc">+</span> ScreenPorch <span class="sc">+</span> PoolArea <span class="sc">+</span> MoSold, <span class="at">data =</span> trainNumericas)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mejorModelo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = SalePrice ~ MSSubClass + LotArea + OverallQual + 
    BsmtFinSF1 + BsmtFinSF2 + TotalBsmtSF + LowQualFinSF + HalfBath + 
    KitchenAbvGr + TotRmsAbvGrd + Fireplaces + WoodDeckSF + OpenPorchSF + 
    EnclosedPorch + X3SsnPorch + ScreenPorch + PoolArea + MoSold, 
    data = trainNumericas)

Residuals:
    Min      1Q  Median      3Q     Max 
-370143  -20054   -2488   15358  334711 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   -1.002e+05  9.893e+03 -10.124  &lt; 2e-16 ***
MSSubClass    -9.181e+01  3.359e+01  -2.733  0.00638 ** 
LotArea        5.358e-01  1.359e-01   3.943 8.61e-05 ***
OverallQual    2.952e+04  1.318e+03  22.399  &lt; 2e-16 ***
BsmtFinSF1     1.706e+01  3.391e+00   5.032 5.74e-07 ***
BsmtFinSF2     5.347e+00  8.114e+00   0.659  0.51004    
TotalBsmtSF    2.400e+01  4.326e+00   5.548 3.69e-08 ***
LowQualFinSF  -2.338e+01  2.681e+01  -0.872  0.38346    
HalfBath       5.668e+03  2.909e+03   1.948  0.05170 .  
KitchenAbvGr  -1.229e+04  7.194e+03  -1.709  0.08784 .  
TotRmsAbvGrd   1.068e+04  1.049e+03  10.181  &lt; 2e-16 ***
Fireplaces     6.663e+03  2.286e+03   2.915  0.00363 ** 
WoodDeckSF     5.320e+01  1.100e+01   4.836 1.53e-06 ***
OpenPorchSF    4.355e+01  2.061e+01   2.113  0.03487 *  
EnclosedPorch -3.583e+01  2.169e+01  -1.652  0.09877 .  
X3SsnPorch     4.487e+01  4.022e+01   1.116  0.26487    
ScreenPorch    6.246e+01  2.507e+01   2.492  0.01288 *  
PoolArea      -2.124e+02  4.081e+01  -5.203 2.38e-07 ***
MoSold        -2.742e+02  4.675e+02  -0.586  0.55772    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 39930 on 1002 degrees of freedom
Multiple R-squared:  0.7546,    Adjusted R-squared:  0.7501 
F-statistic: 171.1 on 18 and 1002 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="árbol-de-regresión" class="level4">
<h4 class="anchored" data-anchor-id="árbol-de-regresión">Árbol de regresión</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>arbol1 <span class="ot">&lt;-</span> <span class="fu">rpart</span>(SalePrice <span class="sc">~</span> .,<span class="at">data=</span>trainNumericas)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(arbol1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HT5_files/figure-html/arbolRegresion-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>ventas <span class="ot">&lt;-</span> testNumericas<span class="sc">$</span>SalePrice</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>test2 <span class="ot">&lt;-</span> testNumericas[,<span class="sc">-</span><span class="dv">81</span>]</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">predict</span>(arbol1,<span class="at">newdata=</span>test2)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>b1<span class="ot">&lt;-</span><span class="fu">mean</span>(a<span class="sc">-</span>test<span class="sc">$</span>GrLivArea)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(test<span class="sc">$</span>GrLivArea,a,<span class="at">col=</span><span class="st">"green"</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span><span class="cn">TRUE</span>)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(test<span class="sc">$</span>GrLivArea,test<span class="sc">$</span>SalePrice,<span class="at">col=</span><span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HT5_files/figure-html/arbolRegresion-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="naive-bayes" class="level4">
<h4 class="anchored" data-anchor-id="naive-bayes">Naive Bayes</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>modeloRegresion<span class="ot">&lt;-</span><span class="fu">naiveBayes</span>(train<span class="sc">$</span>SalePrice<span class="sc">~</span>., <span class="at">data=</span>train)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>predBayes1<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(<span class="fu">levels</span>(<span class="fu">predict</span>(modeloRegresion,<span class="at">newdata =</span> test)))[<span class="dv">1</span><span class="sc">:</span><span class="dv">439</span>]</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>error<span class="ot">&lt;-</span><span class="fu">mean</span>(predBayes1<span class="sc">-</span>test<span class="sc">$</span>GrLivArea)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(test<span class="sc">$</span>GrLivArea,predBayes1,<span class="at">col=</span><span class="st">"green"</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span><span class="cn">TRUE</span>)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(test<span class="sc">$</span>GrLivArea,test<span class="sc">$</span>SalePrice,<span class="at">col=</span><span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HT5_files/figure-html/rnb-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>con los precios bajos le fue bastante bien, aunque tuvo dificultad con los precios altos con el arbol de regresion de la ves pasada tuvimos un error promedio de 181943 y con este tuvimos 160389, lo cual representa una mejora</p>
</section>
</section>
<section id="modelos-de-clasificación" class="level3">
<h3 class="anchored" data-anchor-id="modelos-de-clasificación">Modelos de clasificación</h3>
<section id="árbol-de-decisión" class="level4">
<h4 class="anchored" data-anchor-id="árbol-de-decisión">Árbol de decisión</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>orderPrice <span class="ot">&lt;-</span> datos[<span class="fu">order</span>(datos<span class="sc">$</span>SalePrice),]</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>orderPrice[<span class="st">'Clasificacion'</span>]<span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(orderPrice))</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>orderPrice <span class="ot">&lt;-</span> orderPrice <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(Id, MoSold, YrSold, GarageYrBlt, Alley, LotShape, LandContour, Condition2, YearBuilt, Exterior2nd, FireplaceQu, GarageQual, SaleType,BsmtFinType2, BsmtFinSF2, BsmtUnfSF, BsmtFullBath, BsmtHalfBath, X3SsnPorch, GarageFinish))</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>orderPrice <span class="ot">&lt;-</span> orderPrice <span class="sc">%&gt;%</span> <span class="fu">mutate_at</span> (<span class="fu">c</span>(<span class="st">"MSSubClass"</span>,<span class="st">"MSZoning"</span>, <span class="st">"Utilities"</span>, <span class="st">"LotConfig"</span>, <span class="st">"Street"</span>, <span class="st">"LandSlope"</span>, <span class="st">"Neighborhood"</span>, <span class="st">"Condition1"</span>, <span class="st">"BldgType"</span>, <span class="st">"HouseStyle"</span>, <span class="st">"OverallQual"</span>, <span class="st">"OverallCond"</span>, <span class="st">"RoofStyle"</span>, <span class="st">"PavedDrive"</span>, <span class="st">"RoofMatl"</span>, <span class="st">"Exterior1st"</span>, <span class="st">"MasVnrType"</span>, <span class="st">"ExterQual"</span>, <span class="st">"ExterCond"</span>,<span class="st">"Foundation"</span>, <span class="st">"BsmtQual"</span>, <span class="st">"BsmtCond"</span>, <span class="st">"BsmtExposure"</span>, <span class="st">"BsmtFinType1"</span>, <span class="st">"Heating"</span>, <span class="st">"HeatingQC"</span>, <span class="st">"CentralAir"</span>,<span class="st">"Electrical"</span>, <span class="st">"Functional"</span>, <span class="st">"GarageType"</span>, <span class="st">"GarageCond"</span>, <span class="st">"PoolQC"</span>, <span class="st">"Fence"</span>, <span class="st">"MiscFeature"</span>, <span class="st">"SaleCondition"</span>), as.factor)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>orderPrice<span class="sc">$</span>Clasificacion[orderPrice<span class="sc">$</span>SalePrice <span class="sc">&lt;=</span> <span class="dv">139000</span>] <span class="ot">&lt;-</span> <span class="st">'Economica'</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>orderPrice<span class="sc">$</span>Clasificacion[orderPrice<span class="sc">$</span>SalePrice <span class="sc">&gt;</span> <span class="dv">139000</span> <span class="sc">&amp;</span> orderPrice<span class="sc">$</span>SalePrice <span class="sc">&lt;=</span> <span class="dv">189893</span> ] <span class="ot">&lt;-</span> <span class="st">'Intermedia'</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>orderPrice<span class="sc">$</span>Clasificacion[orderPrice<span class="sc">$</span>SalePrice <span class="sc">&gt;</span> <span class="dv">189893</span>] <span class="ot">&lt;-</span> <span class="st">'Cara'</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>orderPrice <span class="ot">&lt;-</span> orderPrice<span class="sc">%&gt;%</span><span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"Clasificacion"</span>),as.factor)</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>economicas <span class="ot">&lt;-</span> orderPrice[orderPrice<span class="sc">$</span>Clasificacion <span class="sc">==</span> <span class="st">'Economica'</span>,]</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>intermedias <span class="ot">&lt;-</span> orderPrice[orderPrice<span class="sc">$</span>Clasificacion <span class="sc">==</span> <span class="st">'Intermedia'</span>,]</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>caras <span class="ot">&lt;-</span> orderPrice[orderPrice<span class="sc">$</span>Clasificacion <span class="sc">==</span> <span class="st">'Cara'</span>,]</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>filasCasasE <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(economicas), <span class="fu">nrow</span>(economicas)<span class="sc">*</span><span class="fl">0.7</span>)</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>filasCasasI <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(intermedias), <span class="fu">nrow</span>(intermedias)<span class="sc">*</span><span class="fl">0.7</span>)</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>filasCasasC <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(caras), <span class="fu">nrow</span>(caras)<span class="sc">*</span><span class="fl">0.7</span>)</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> <span class="fu">rbind</span>(economicas[filasCasasE,], intermedias[filasCasasI,], caras[filasCasasC,])</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">rbind</span>(economicas[<span class="sc">-</span>filasCasasE,], intermedias[<span class="sc">-</span>filasCasasI,], caras[<span class="sc">-</span>filasCasasC,])</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span> test[,<span class="st">"Clasificacion"</span>]</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>dataResp <span class="ot">&lt;-</span> test</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> test<span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">"SalePrice"</span>, <span class="st">"Clasificacion"</span>))</span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">"SalePrice"</span>))</span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>modeloClasificacion <span class="ot">&lt;-</span> <span class="fu">rpart</span>(Clasificacion<span class="sc">~</span>., train, <span class="at">method =</span> <span class="st">"class"</span>)</span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(modeloClasificacion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HT5_files/figure-html/arbolDecision-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>ypred <span class="ot">&lt;-</span> <span class="fu">predict</span>(modeloClasificacion, <span class="at">newdata =</span> test)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>ypred <span class="ot">&lt;-</span> <span class="fu">apply</span>(ypred, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">colnames</span>(ypred)[<span class="fu">which.max</span>(x)])</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>ypred <span class="ot">&lt;-</span> <span class="fu">factor</span>(ypred)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ypred , <span class="at">col=</span><span class="st">"green"</span>,<span class="at">density=</span><span class="dv">20</span>,<span class="at">angle=</span><span class="dv">135</span>)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(y, <span class="at">col=</span><span class="st">"blue"</span>,<span class="at">density=</span><span class="dv">20</span>,<span class="at">angle=</span><span class="dv">45</span>,<span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">beside =</span> <span class="cn">TRUE</span>)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottom"</span>,</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">"Predicción del modelo"</span>,<span class="st">"Datos reales"</span>),</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="at">fill=</span><span class="fu">c</span>(<span class="st">"green"</span>,<span class="st">"blue"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HT5_files/figure-html/arbolDecision-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(ypred, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

            Reference
Prediction   Cara Economica Intermedia
  Cara        115         2         24
  Economica     3       121         27
  Intermedia   32        22         93

Overall Statistics
                                          
               Accuracy : 0.7494          
                 95% CI : (0.7062, 0.7893)
    No Information Rate : 0.3417          
    P-Value [Acc &gt; NIR] : &lt;2e-16          
                                          
                  Kappa : 0.6242          
                                          
 Mcnemar's Test P-Value : 0.6035          

Statistics by Class:

                     Class: Cara Class: Economica Class: Intermedia
Sensitivity               0.7667           0.8345            0.6458
Specificity               0.9100           0.8980            0.8169
Pos Pred Value            0.8156           0.8013            0.6327
Neg Pred Value            0.8826           0.9167            0.8253
Prevalence                0.3417           0.3303            0.3280
Detection Rate            0.2620           0.2756            0.2118
Detection Prevalence      0.3212           0.3440            0.3349
Balanced Accuracy         0.8384           0.8662            0.7314</code></pre>
</div>
</div>
</section>
<section id="naive-bayes-1" class="level4">
<h4 class="anchored" data-anchor-id="naive-bayes-1">Naive Bayes</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>modeloNB<span class="ot">&lt;-</span><span class="fu">naiveBayes</span>(Clasificacion<span class="sc">~</span>.,<span class="at">data=</span>train)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>predNB<span class="ot">&lt;-</span> <span class="fu">predict</span>(modeloNB,<span class="at">newdata =</span> test)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>predNB <span class="ot">&lt;-</span> <span class="fu">factor</span>(predNB)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(predNB , <span class="at">col=</span><span class="st">"green"</span>,<span class="at">density=</span><span class="dv">20</span>,<span class="at">angle=</span><span class="dv">135</span>)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(y, <span class="at">col=</span><span class="st">"blue"</span>, <span class="at">density=</span><span class="dv">20</span>,<span class="at">angle=</span><span class="dv">45</span>,<span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">beside =</span> <span class="cn">TRUE</span>)</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottom"</span>,</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">"Predicción del modelo"</span>,<span class="st">"Datos reales"</span>),</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="at">fill=</span><span class="fu">c</span>(<span class="st">"green"</span>,<span class="st">"blue"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HT5_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(predNB, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

            Reference
Prediction   Cara Economica Intermedia
  Cara        123         0         22
  Economica     8       139         67
  Intermedia   19         6         55

Overall Statistics
                                          
               Accuracy : 0.7221          
                 95% CI : (0.6776, 0.7635)
    No Information Rate : 0.3417          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.5829          
                                          
 Mcnemar's Test P-Value : 8.746e-13       

Statistics by Class:

                     Class: Cara Class: Economica Class: Intermedia
Sensitivity               0.8200           0.9586            0.3819
Specificity               0.9239           0.7449            0.9153
Pos Pred Value            0.8483           0.6495            0.6875
Neg Pred Value            0.9082           0.9733            0.7521
Prevalence                0.3417           0.3303            0.3280
Detection Rate            0.2802           0.3166            0.1253
Detection Prevalence      0.3303           0.4875            0.1822
Balanced Accuracy         0.8719           0.8518            0.6486</code></pre>
</div>
</div>
<p>Veamos que la predicción de este modelo es peor a la del árbol de claasficiación. Al igual que el anterior, tiene una mayor facilidad para clasificar las casas de los niveles extremos, pero podemos ver que se confunde más con las casas de precio Intermedio. Se puede ver de manera bastante clara en la gráfica, sin embargo notemos que el árbol de clasificación es igualmente solo 2.5% más eficiente que el Naive Bayes. Una ventaja del Naive Bayes en este caso es que es más fácil ver en dónde se está equivocando de manera gráfica, a diferencia del árbol de clasificación.</p>
</section>
<section id="overfitting" class="level4">
<h4 class="anchored" data-anchor-id="overfitting">Overfitting</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>modeloNBp<span class="ot">&lt;-</span><span class="fu">naiveBayes</span>(Clasificacion<span class="sc">~</span>.,<span class="at">data=</span>train)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>predNBp<span class="ot">&lt;-</span> <span class="fu">predict</span>(modeloNBp,<span class="at">newdata =</span> train[,<span class="sc">-</span><span class="dv">61</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in predict.naiveBayes(modeloNBp, newdata = train[, -61]): Type mismatch
between training and new data for variable 'YearsBuilt'. Did you use factors
with numeric labels for training, and numeric values for new data?</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>predNBp <span class="ot">&lt;-</span> <span class="fu">factor</span>(predNBp)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(predNBp, train<span class="sc">$</span>Clasificacion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

            Reference
Prediction   Cara Economica Intermedia
  Cara        287         0         44
  Economica    14       329        139
  Intermedia   46         9        153

Overall Statistics
                                          
               Accuracy : 0.7532          
                 95% CI : (0.7255, 0.7794)
    No Information Rate : 0.3399          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.6297          
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       

Statistics by Class:

                     Class: Cara Class: Economica Class: Intermedia
Sensitivity               0.8271           0.9734            0.4554
Specificity               0.9347           0.7760            0.9197
Pos Pred Value            0.8671           0.6826            0.7356
Neg Pred Value            0.9130           0.9833            0.7749
Prevalence                0.3399           0.3310            0.3291
Detection Rate            0.2811           0.3222            0.1499
Detection Prevalence      0.3242           0.4721            0.2037
Balanced Accuracy         0.8809           0.8747            0.6875</code></pre>
</div>
</div>
<p>Veamos que la eficacia del modelo con los datos de entrenamiento es solo <span class="math inline">\(3.5\%\)</span> más eficaz que con los datos de prueba, por lo que podemos descartar el overfitting como problema del modelo</p>
</section>
</section>
<section id="validación-cruzada" class="level3">
<h3 class="anchored" data-anchor-id="validación-cruzada">Validación cruzada</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>tc <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">'cv'</span>, <span class="at">number =</span><span class="dv">10</span>, <span class="at">verboseIter =</span> T)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(<span class="fu">lapply</span>(train, unique), length)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   MSSubClass      MSZoning   LotFrontage       LotArea        Street 
           15             5           105           795             2 
    Utilities     LotConfig     LandSlope  Neighborhood    Condition1 
            1             5             3            25             9 
     BldgType    HouseStyle   OverallQual   OverallCond  YearRemodAdd 
            5             8            10             8            61 
    RoofStyle      RoofMatl   Exterior1st    MasVnrType    MasVnrArea 
            6             8            15             5           262 
    ExterQual     ExterCond    Foundation      BsmtQual      BsmtCond 
            4             4             6             5             4 
 BsmtExposure  BsmtFinType1    BsmtFinSF1   TotalBsmtSF       Heating 
            5             7           496           581             5 
    HeatingQC    CentralAir    Electrical     X1stFlrSF     X2ndFlrSF 
            5             2             5           622           309 
 LowQualFinSF     GrLivArea      FullBath      HalfBath  BedroomAbvGr 
           16           691             4             3             7 
 KitchenAbvGr   KitchenQual  TotRmsAbvGrd    Functional    Fireplaces 
            3             4            11             6             4 
   GarageType    GarageCars    GarageArea    GarageCond    PavedDrive 
            7             5           363             6             3 
   WoodDeckSF   OpenPorchSF EnclosedPorch   ScreenPorch      PoolArea 
          220           175           100            55             7 
       PoolQC         Fence   MiscFeature       MiscVal SaleCondition 
            4             5             5            16             5 
   YearsBuilt      YearsRem Clasificacion 
          108            61             3 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(train))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   MSSubClass      MSZoning   LotFrontage       LotArea        Street 
            0             0           188             0             0 
    Utilities     LotConfig     LandSlope  Neighborhood    Condition1 
            0             0             0             0             0 
     BldgType    HouseStyle   OverallQual   OverallCond  YearRemodAdd 
            0             0             0             0             0 
    RoofStyle      RoofMatl   Exterior1st    MasVnrType    MasVnrArea 
            0             0             0             4             4 
    ExterQual     ExterCond    Foundation      BsmtQual      BsmtCond 
            0             0             0            26            26 
 BsmtExposure  BsmtFinType1    BsmtFinSF1   TotalBsmtSF       Heating 
           27            26             0             0             0 
    HeatingQC    CentralAir    Electrical     X1stFlrSF     X2ndFlrSF 
            0             0             1             0             0 
 LowQualFinSF     GrLivArea      FullBath      HalfBath  BedroomAbvGr 
            0             0             0             0             0 
 KitchenAbvGr   KitchenQual  TotRmsAbvGrd    Functional    Fireplaces 
            0             0             0             0             0 
   GarageType    GarageCars    GarageArea    GarageCond    PavedDrive 
           56             0             0            56             0 
   WoodDeckSF   OpenPorchSF EnclosedPorch   ScreenPorch      PoolArea 
            0             0             0             0             0 
       PoolQC         Fence   MiscFeature       MiscVal SaleCondition 
         1015           833           989             0             0 
   YearsBuilt      YearsRem Clasificacion 
            0             0             0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>traincv <span class="ot">&lt;-</span> train[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">38</span>, <span class="dv">39</span>, <span class="dv">40</span>, <span class="dv">41</span>, <span class="dv">45</span>, <span class="dv">47</span>, <span class="dv">55</span>, <span class="dv">56</span>)]</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>testcv <span class="ot">&lt;-</span> test[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">38</span>, <span class="dv">39</span>, <span class="dv">40</span>, <span class="dv">41</span>, <span class="dv">45</span>, <span class="dv">47</span>, <span class="dv">55</span>, <span class="dv">56</span>, <span class="dv">57</span>)]</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>traincv <span class="ot">&lt;-</span> traincv <span class="sc">%&gt;%</span> <span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">'LotArea'</span>, <span class="st">'YearsBuilt'</span>, <span class="st">'YearsRem'</span>, <span class="st">'BsmtFinSF1'</span>, <span class="st">'TotalBsmtSF'</span>, <span class="st">'X1stFlrSF'</span>, <span class="st">'X2ndFlrSF'</span>, <span class="st">'LowQualFinSF'</span>, <span class="st">'GrLivArea'</span>, <span class="st">'TotRmsAbvGrd'</span>, <span class="st">'GarageArea'</span>, <span class="st">'WoodDeckSF'</span>, <span class="st">'OpenPorchSF'</span>, <span class="st">'EnclosedPorch'</span>, <span class="st">'ScreenPorch'</span>, <span class="st">'MiscVal'</span>), scale)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>testcv <span class="ot">&lt;-</span> testcv <span class="sc">%&gt;%</span> <span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">'LotArea'</span>, <span class="st">'YearsBuilt'</span>, <span class="st">'YearsRem'</span>, <span class="st">'BsmtFinSF1'</span>, <span class="st">'TotalBsmtSF'</span>, <span class="st">'X1stFlrSF'</span>, <span class="st">'X2ndFlrSF'</span>, <span class="st">'LowQualFinSF'</span>, <span class="st">'GrLivArea'</span>, <span class="st">'TotRmsAbvGrd'</span>, <span class="st">'GarageArea'</span>, <span class="st">'WoodDeckSF'</span>, <span class="st">'OpenPorchSF'</span>, <span class="st">'EnclosedPorch'</span>, <span class="st">'ScreenPorch'</span>, <span class="st">'MiscVal'</span>), scale)</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="co">#set.seed(456)</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="co">#mcv &lt;- train(traincv$Clasificacion ~., data = traincv[, -53], method = 'nb', trControl = tc, na.action = na.omit)</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="co">#y2pred &lt;- predict(mcv, newdata = test)</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a><span class="co"># confusionMatrix(y2pred, y)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>